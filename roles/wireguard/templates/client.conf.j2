[Interface]
PrivateKey = {{ lookup('file', wireguard_pki_path + '/private/' + item.1) }}
Address = {{ wireguard_client_ip }}
{% if wireguard_dns_servers|length > 0 %}
DNS = {{ wireguard_dns_servers }}
{% endif %}
{% if wireguard_reduce_mtu|int > 0 %}MTU = {{ 1420 - reduce_mtu|int }}
{% endif %}

[Peer]
PublicKey = {{ lookup('file', wireguard_pki_path + '/public/' + wireguard_host_ip) }}
PresharedKey = {{ lookup('file', wireguard_pki_path + '/preshared/' + item.1) }}
AllowedIPs = 0.0.0.0/0,::/0
Endpoint = {{ wireguard_host_ip }}:{{ wireguard_port }}
{{ 'PersistentKeepalive = ' + wireguard_persistentkeepalive|string if wireguard_persistentkeepalive > 0 else '' }}
